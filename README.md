# JCoinbase

![GitHub Workflow Status](https://img.shields.io/github/workflow/status/Bad-Pop/JCoinbase/JCoinbase%20CI?style=plastic)
![Sonar Coverage](https://img.shields.io/sonar/coverage/JCoinbase?server=https%3A%2F%2Fsonarcloud.io)
![Sonar Tech Debt](https://img.shields.io/sonar/tech_debt/JCoinbase?server=https%3A%2F%2Fsonarcloud.io)
![Sonar Tests](https://img.shields.io/sonar/tests/JCoinbase?compact_message&failed_label=failed&passed_label=passed&server=https%3A%2F%2Fsonarcloud.io&skipped_label=skipped)
![Sonar Quality Gate](https://img.shields.io/sonar/quality_gate/JCoinbase?server=https%3A%2F%2Fsonarcloud.Io)
![GitHub last commit](https://img.shields.io/github/last-commit/Bad-Pop/JCoinbase)
![GitHub](https://img.shields.io/github/license/Bad-Pop/JCoinbase)
![GitHub contributors](https://img.shields.io/github/contributors/Bad-Pop/JCoinbase)
___

**This project is still under active development and is made with :heart:**

JCoinbase is an open source client for the Coinbase exchange platform API written in java 15. It allows you to make queries to the Coinbase API in a quick and easy way.


## Getting started

To make requests to the Coinbase API using JCoinbase, simply instantiate a new `JcoinbaseClient` via the `JCoinbaseClientFactory`

```java  
JCoinbaseClient client = JCoinbaseClientFactory.build(yourApiKey, yourSecret, desiredTimoutInSecond, threadSafeSingleton);  
```

- Api key : Your api key generated by Coinbase in your profile settings.
- Secret : Your secret generated by Coinbase in your profile settings.
- desiredTimeoutInSeconds : A long value that defines the timeout in seconds for http requests. Recommended value is 3.
- threadSafeSingleton : A boolean defining if the `JCoinbaseClient` should be build as a thread safe singleton.

_Notice that, if you pass `null` for the api key and the secret, you won't be able to access non-public data :  user, account, addresses, transactions, buy, sell, deposit, withdrawals and payment methods._

Then, you can simply call Coinbase resources like that :

```java
CallResult<Seq<CoinbaseError>, User> currentUser = client.user().getCurrentUser();  
```

Please note that, by default, returned values use Vavr data types for objects like `Collections` or `Option`.  
So if you don't want to use Vavr, you can always get java objects via the api.

For example :

```java
CallResult<io.vavr.collection.Seq<CoinbaseError>, User> currentUser = client.user().getCurrentUser();
CallResult<java.util.List<CoinbaseError>, User> currentUser = client.user().getCurrentUserAsJava();
```  

For further information on Vavr, please take a look at : [https://www.vavr.io/](https://www.vavr.io/)


## The CallResult class

CallResult represents a value of two possible types, a Failure or a Success.
In this example, if this is a failure, `client.user().getCurrentUser()` will return a `CallResult.Failure`,
otherwise it will return a `CallResult.Success`. CallResult, is a simplified version of the vavr `Either` and provide you a powerful API based on lambdas.
Thus, you are not dependent on vavr if you do not wish to use it.

### CallResult usage examples

For this example we want to get the current user (based on the given api key) :
```java
CallResult<Seq<CoinbaseError>, User> currentUser = client.user().getCurrentUser();
```

Then, as explained, a CallResult can contain a value representing a failure or a success. So imagine we want to access the user inside this CallResult.
We can use multiple methods :
```java
currentUser.get(); //Get the user. Throws exception if this is a failure
currentUser.getOrNull(); //Get the user or return null if this is a failure
currentUser.getOrElse(User.builder()[...].build()); //Get the user or return the given user if this is a failure
currentUser.getOrElse(() -> myInstruction()) //Get the user or execute myInstruction() if this is a failure
currentUser.getOrElseThrow(() -> new RuntimeException()); //Get the user or throws a new exception if this is a failure
currentUser.getOrElseTry(OneClass::methodToInvoke); //Get the underlying user or the result of Try.of(theSupplier).get()
```

Now, imagine that we want to map the underlying user to another thing :
```java
currentUser.map(User::getId) //This method maps the value of this CallResult if it is a Success and performs no operation if this is a Failure.
```

Note that the map is also available for the Failure side of a CallResult using `mapFailure()` :
```java
currentUser.mapFailure(coinbaseErrors -> coinbaseErrors.map(CoinbaseError::getMessage)); //Transform the CoinbaseErrors to a list of messages if this is a failure. Do nothing otherwise.
```

CallResult also gives you access to useful methods like:
```java
currentUser.isSuccess(); //Return true if this is a success, false otherwise
currentUser.isFailure(); //Return true if this is a failure, false otherwise
currentUser.isEmpty(); //Return true if this a success with an underlying value, false otherwise
```

Many other methods are available in the CallResult api, like `peek()`, `bimap()`, `flatMap()`, `orElse()`, `fold()`, `toOption()`, `toJavaOptional()` ...


## Features

- **Public data**
  - :white_check_mark: Time
  - :white_check_mark: Currencies
  - :white_check_mark: Exchange rates
  - :white_check_mark: Buy prices
  - :white_check_mark: Sell prices
  - :white_check_mark: Spot prices
- **Users**
  - :white_check_mark: Current user's data
  - :white_check_mark: Current user's authorizations
  - :white_check_mark: Users' data by user id
  - :white_check_mark: Update current user
- **Accounts**
  - :x: List accounts
  - :x: Show an account
  - :x: Update account
  - :x: Delete account
- **Addresses**
  - :x: List addresses
  - :x: Show addresses
  - :x: List address's transactions
  - :x: Create address
- **Transactions**
  - :x: List transactions
  - :x: Show a transaction
  - :x: Send money
  - :x: Transfer money between accounts
  - :x: Request money
  - :x: Complete request money
  - :x: Re-send request money
  - :x: Cancel request money
- **Buys**
  - :x: List buys
  - :x: Show a buy
  - :x: Place buy order
  - :x: Commit a buy
- **Sells**
  - :x: List sells
  - :x: Show a sell
  - :x: Place sell order
  - :x: Commit a sell
- **Deposits**
  - :x: List deposits
  - :x: Show a deposit
  - :x: Deposit funds
  - :x: Commit a deposit
- **Withdrawals**
  - :x: List withdrawals
  - :x: Show a withdrawal
  - :x: Withdraw funds
  - :x: Commit a withdrawals
- **Payment methods**
  - :x: List payment methods
  - :x: Show a payment method


## Build project locally
If you don't have maven installed, you can use the maven wrapper presents inside the project :
```shell
./mvnw clean install
```
If you are on windows you can use the `mvnw.cmd` which also wrap maven on windows.
Else, if you have Maven installed you can run :
```shell
mvn clean install
```


## Status
This project is currently being maintained, and will be maintained. If you like this project and want this project to never exhaust, please consider helping or donating <3.